# Silverlight 3.0 içerisinde görsel veri validasyonu. 

Silverlight içerisinde veri validasyonu konusunda validasyon
kontrollerimiz yok gibi gözükse de aslında arka planda işimize
yarayabilecek ilginç bir sistem var. Bu sistemi hem tasarımcı hem de
yazılımcı beraber kullanırlarsa ortaya çok güzel sonuçlar çıkabilir. Bu
yazımızda nesne bazlı veri validasyonunu nasıl yapabiliriz konusuna göz
atacağız.

Hemen örneğimize başlama yoluna uygulamamızın ekranına bir DataGrid
koyalım. Bir sonraki adımda uygun nesneleri yaratarak bu Grid'e
bağlayacağız sonrasında da Grid içerisinde hücre başına validasyon
yapmaya çalışacağız.

**[XAML]**

<span style="color: blue;">\<</span><span
style="color: #a31515;">UserControl</span><span style="color: red;">
xmlns</span><span style="color: blue;">:</span><span
style="color: red;">data</span><span
style="color: blue;">="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"</span>

       <span style="color: red;"> x</span><span
style="color: blue;">:</span><span style="color: red;">Class</span><span
style="color: blue;">="SilverlightApplication81.MainPage"</span><span
style="color: red;"> xmlns</span><span
style="color: blue;">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>

       <span style="color: red;"> xmlns</span><span
style="color: blue;">:</span><span style="color: red;">x</span><span
style="color: blue;">="http://schemas.microsoft.com/winfx/2006/xaml"</span><span
style="color: red;"> Width</span><span
style="color: blue;">="400"</span><span style="color: red;">
Height</span><span style="color: blue;">="300"\></span>

<span style="color: #a31515;">    </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Grid</span><span style="color: red;">
x</span><span style="color: blue;">:</span><span
style="color: red;">Name</span><span
style="color: blue;">="LayoutRoot"</span><span style="color: red;">
Background</span><span style="color: blue;">="White"\></span>

<span style="color: #a31515;">        </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">data</span><span
style="color: blue;">:</span><span
style="color: #a31515;">DataGrid</span><span style="color: red;">
x</span><span style="color: blue;">:</span><span
style="color: red;">Name</span><span
style="color: blue;">="myGrid"\>\</</span><span
style="color: #a31515;">data</span><span
style="color: blue;">:</span><span
style="color: #a31515;">DataGrid</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">    </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">Grid</span><span style="color: blue;">\></span>

<span style="color: blue;">\</</span><span
style="color: #a31515;">UserControl</span><span
style="color: blue;">\></span>

Görsel tarafı en azından şimdilik hallettiğimize göre hemen veri
tarafına geçip işimizi görecek kadar örnek veri yaratalım. İlk olarak
verimiz içerisinde her nesneyi tanımlayacak olan Urun sınıfını
hazırlıyoruz.

**[VB]**

    <span style="color: blue;">Public</span> <span
style="color: blue;">Class</span> Urun

 

        <span style="color: blue;">Private</span> PAdi <span
style="color: blue;">As</span> <span style="color: blue;">String</span>

        <span style="color: blue;">Public</span> <span
style="color: blue;">Property</span> Adi() <span
style="color: blue;">As</span> <span style="color: blue;">String</span>

            <span style="color: blue;">Get</span>

                <span style="color: blue;">Return</span> PAdi

            <span style="color: blue;">End</span> <span
style="color: blue;">Get</span>

            <span style="color: blue;">Set</span>(<span
style="color: blue;">ByVal</span> value <span
style="color: blue;">As</span> <span style="color: blue;">String</span>)

                PAdi = value

            <span style="color: blue;">End</span> <span
style="color: blue;">Set</span>

        <span style="color: blue;">End</span> <span
style="color: blue;">Property</span>

 

        <span style="color: blue;">Private</span> PSatis <span
style="color: blue;">As</span> <span style="color: blue;">Integer</span>

        <span style="color: blue;">Public</span> <span
style="color: blue;">Property</span> Satis() <span
style="color: blue;">As</span> <span style="color: blue;">Integer</span>

            <span style="color: blue;">Get</span>

                <span style="color: blue;">Return</span> PSatis

            <span style="color: blue;">End</span> <span
style="color: blue;">Get</span>

            <span style="color: blue;">Set</span>(<span
style="color: blue;">ByVal</span> value <span
style="color: blue;">As</span> <span
style="color: blue;">Integer</span>)

                PSatis = value

            <span style="color: blue;">End</span> <span
style="color: blue;">Set</span>

        <span style="color: blue;">End</span> <span
style="color: blue;">Property</span>

 

    <span style="color: blue;">End</span> <span
style="color: blue;">Class</span>

Göreceğiniz üzere **Urun** sınıfının sadece iki tane Property'si var.
Bunlardan biri ürünün adını taşırken diğeri ise toplam satış rakamını
taşıyacak. Bu sınıfımızdan bir liste yaratarak rastgele urunler ekleyip
Grid'imize basit bir şekilde bağlayacağız.

**[VB]**

    <span style="color: blue;">Private</span> <span
style="color: blue;">Sub</span> MainPage\_Loaded(<span
style="color: blue;">ByVal</span> sender <span
style="color: blue;">As</span> <span style="color: blue;">Object</span>,
<span style="color: blue;">ByVal</span> e <span
style="color: blue;">As</span> System.Windows.RoutedEventArgs) <span
style="color: blue;">Handles</span> <span
style="color: blue;">Me</span>.Loaded

        <span style="color: blue;">Dim</span> Liste <span
style="color: blue;">As</span> <span style="color: blue;">New</span>
List(<span style="color: blue;">Of</span> Urun)

        <span style="color: blue;">For</span> index <span
style="color: blue;">As</span> <span style="color: blue;">Integer</span>
= 1 <span style="color: blue;">To</span> 10

            Liste.Add(<span style="color: blue;">New</span> Urun() <span
style="color: blue;">With</span> {.Adi = <span
style="color: #a31515;">"Ürün Adi"</span> & index, .Satis = Rnd() \*
50})

        <span style="color: blue;">Next</span>

 

        myGrid.ItemsSource = Liste

    <span style="color: blue;">End</span> <span
style="color: blue;">Sub</span>

Bütün bu manzara içerisinde bir anda aklınızda "ürün isimleri boş
bırakılmasın" şeklinde bir validasyon geldiğini varsayalım. Peki ne
yapacağız? Aslında konu tahmin edeceğinizden çok daha basit. İlk olarak
validasyon işlemini yapabileceğimiz basit bir yer var, orası da **Urun**
sınıfımızın Property'lerinin **Set** durumu.

**[VB]**

       <span style="color: blue;">Private</span> PAdi <span
style="color: blue;">As</span> <span style="color: blue;">String</span>

        <span style="color: blue;">Public</span> <span
style="color: blue;">Property</span> Adi() <span
style="color: blue;">As</span> <span style="color: blue;">String</span>

            <span style="color: blue;">Get</span>

                <span style="color: blue;">Return</span> PAdi

            <span style="color: blue;">End</span> <span
style="color: blue;">Get</span>

            <span style="color: blue;">Set</span>(<span
style="color: blue;">ByVal</span> value <span
style="color: blue;">As</span> <span style="color: blue;">String</span>)

                <span style="color: blue;">If</span> <span
style="color: blue;">String</span>.IsNullOrEmpty(value) <span
style="color: blue;">Then</span>

                    <span style="color: blue;">Throw</span> <span
style="color: blue;">New</span> ValidationException(<span
style="color: #a31515;">"isim boş geçilemez!"</span>)

                <span style="color: blue;">Else</span>

                    PAdi = value

                <span style="color: blue;">End</span> <span
style="color: blue;">If</span>

 

            <span style="color: blue;">End</span> <span
style="color: blue;">Set</span>

        <span style="color: blue;">End</span> <span
style="color: blue;">Property</span>

Yukarıdaki kod içerisinde sadece tek bir Property'nin set ve get
durumunu görüyorsunuz. İlk baştaki örneğimizden farklı olarak **Set**
işleminde gelen value'yu kontrol ediyoruz. Eğer Grid içerisinde bu
Property'e denk gelen TextBox boş bırakılırsa doğan olarak arka tarafa
grid boş değer döndürerek söz konusu nesnenin property'sini değiştirmeye
çalışacak. İşte tam da o notkada devreye girip kontrolleri yapıp
gerekiyorsa bir **ValidationException** fırlatıyoruz. Exception
fırlatırken kullanıcıya vermek istediğimiz mesajı da parametre olarak
constructor'a geçebiliriz.

Eğer projeyi bu hali ile Debug modunda açarsanız hatayı Debug tarafında
görürsünüz. Oysa projeyi Debug mode yerine normal şekilde
çalıştırırsanız aşağıdaki manzara ile karşılaşacaksınız.

![Basit bir validasyon
sonucu...](media/Silverlight_3_0_icerisinde_gorsel_veri_validasyonu/03072009_1.png)\
*Basit bir validasyon sonucu...*

Gördüğünüz gibi manzara gerçekten çok hoş. Görsel olarak da güzel bir
animasyon ile sahneye gelen bu tooltip çoğu validasyon ihtiyacınızı
giderecektir. Grid içerisinde herhangi bir ek işleme gerek kalmadan
validasyonu çalışır hale getirmiş olsak da farklı kontrollerde Binding
ayarlarken vermeniz gereken ek parametreler de mevcut.

**[XAML]**

<span style="color: blue;">\<</span><span
style="color: #a31515;">UserControl</span><span style="color: red;">
xmlns</span><span style="color: blue;">:</span><span
style="color: red;">data</span><span
style="color: blue;">="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"</span>

       <span style="color: red;"> x</span><span
style="color: blue;">:</span><span style="color: red;">Class</span><span
style="color: blue;">="SilverlightApplication81.MainPage"</span><span
style="color: red;"> xmlns</span><span
style="color: blue;">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>

       <span style="color: red;"> xmlns</span><span
style="color: blue;">:</span><span style="color: red;">x</span><span
style="color: blue;">="http://schemas.microsoft.com/winfx/2006/xaml"</span><span
style="color: red;"> Width</span><span
style="color: blue;">="400"</span><span style="color: red;">
Height</span><span style="color: blue;">="300"\></span>

<span style="color: #a31515;">    </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Grid</span><span style="color: red;">
x</span><span style="color: blue;">:</span><span
style="color: red;">Name</span><span
style="color: blue;">="LayoutRoot"</span><span style="color: red;">
Background</span><span style="color: blue;">="White"\></span>

<span style="color: #a31515;">        </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">data</span><span
style="color: blue;">:</span><span
style="color: #a31515;">DataGrid</span><span style="color: red;">
x</span><span style="color: blue;">:</span><span
style="color: red;">Name</span><span
style="color: blue;">="myGrid"</span><span style="color: red;">
AutoGenerateColumns</span><span style="color: blue;">="False"\></span>

<span style="color: #a31515;">            </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">data</span><span
style="color: blue;">:</span><span
style="color: #a31515;">DataGrid.Columns</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">data</span><span
style="color: blue;">:</span><span
style="color: #a31515;">DataGridTemplateColumn</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                    </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">data</span><span
style="color: blue;">:</span><span
style="color: #a31515;">DataGridTemplateColumn.CellTemplate</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                        </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">DataTemplate</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                            </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">TextBox</span><span style="color: red;">
Text</span><span style="color: blue;">="{</span><span
style="color: #a31515;">Binding</span><span style="color: red;">
Adi</span><span style="color: blue;">}" /\></span>

<span style="color: #a31515;">                        </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">DataTemplate</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                    </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">data</span><span
style="color: blue;">:</span><span
style="color: #a31515;">DataGridTemplateColumn.CellTemplate</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">data</span><span
style="color: blue;">:</span><span
style="color: #a31515;">DataGridTemplateColumn</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">            </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">data</span><span
style="color: blue;">:</span><span
style="color: #a31515;">DataGrid.Columns</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">        </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">data</span><span
style="color: blue;">:</span><span
style="color: #a31515;">DataGrid</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">    </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">Grid</span><span style="color: blue;">\></span>

<span style="color: blue;">\</</span><span
style="color: #a31515;">UserControl</span><span
style="color: blue;">\></span>

Gridimizi yukarıdaki şekli ile biraz değiştirdik. Artık DataGrid ile
beraber gelen hazır kolonları değil de özel kolon tasarımlarını
kullandığımızı düşünelim. Bizim örneğimizde sadece Adi kolonunu ekledik
ve bu kolonun tasarımına da bir TextBox koyduk. Böylece bu kolon sürekli
TextBox olarak gözükecek. Peki acaba bu TextBox'ı da boş bıraktığımızda
validasyon hatasını görebilecek miyiz? Maalesef hayır.

**[XAML]**

<span style="color: gray;">\<UserControl
xmlns:data="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"</span>

<span style="color: gray">       </span> <span style="color: gray;">
x:Class="SilverlightApplication81.MainPage"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>

<span style="color: gray">       </span> <span style="color: gray;">
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Width="400"
Height="300"\></span>

<span style="color: gray;">    \<Grid x:Name="LayoutRoot"
Background="White"\></span>

<span style="color: gray;">        \<data:DataGrid x:Name="myGrid"
AutoGenerateColumns="False"\></span>

<span style="color: gray;">            \<data:DataGrid.Columns\></span>

<span style="color: gray;">               
\<data:DataGridTemplateColumn\></span>

<span style="color: gray;">                   
\<data:DataGridTemplateColumn.CellTemplate</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                        </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">DataTemplate</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                            </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">TextBox</span><span style="color: red;">
Text</span><span style="color: blue;">="{</span><span
style="color: #a31515;">Binding</span><span style="color: red;">
Mode</span><span style="color: blue;">=TwoWay,</span><span
style="color: red;"> NotifyOnValidationError</span><span
style="color: blue;">=true,</span><span style="color: red;">
Path</span><span style="color: blue;">=Adi,</span><span
style="color: red;"> ValidatesOnExceptions</span><span
style="color: blue;">=true}" /\></span>

<span style="color: #a31515;">                        </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">DataTemplate</span><span
style="color: blue;">\></span>

<span style="color: #808080;">                   
\</data:DataGridTemplateColumn.CellTemplate\></span>

<span style="color: #808080;">               
\</data:DataGridTemplateColumn\></span>

<span style="color: #808080;">           
\</data:DataGrid.Columns\></span>

<span style="color: #808080;">        \</data:DataGrid\></span>

<span style="color: #808080;">    \</Grid\></span>

<span style="color: #808080;">\</UserControl</span><span
style="color: blue;">\></span>

Bu noktada değiştirmemiz gereken şey Binding mekanizmamızla alakalı
ayarlar. İlk olarak **Mode'u** **TwoWay** yaparak buradaki
değişikliklerin de nesne tarafına yansımasını sağlıyoruz ki nesne
tarafındaki validasyon gerçekleşsin. Ayrıca **NotifyOnValidationError**
ve **ValidatesOnExceptions** özelliklerini de **True** yaparak gerekli
hataların gösterilmesini sağlıyoruz.

![Özel binding ile
validasyon.](media/Silverlight_3_0_icerisinde_gorsel_veri_validasyonu/03072009_2.png)\
*Özel binding ile validasyon.*

**Görselliği değiştirelim...**

Herhangi bir kontrolün validation işlemi sonrasında InValid olması
haline gösterilmek üzere InValid State'lerinin bulunması gerekir. Hali
hazırda Silverlight içerisindeki çoğu kontrolde bu state'ler zaten hazır
ve tasarımları yapılmış durumda. Eğer yukarıdaki örneğimizi Expression
Blend ile açar ve TextBox'ın Template'ini editlemek isterseniz söz
konusu menüde "**Edit a copy**" demeyi unutmayın.

![TextBox kontolümüzü Template'ini kopyalayarak
editleyelim.](media/Silverlight_3_0_icerisinde_gorsel_veri_validasyonu/03072009_3.png)\
*TextBox kontolümüzü Template'ini kopyalayarak editleyelim.*

Böylece Blend sizin yerinize standart şablonu kopyalayacaktır. Bunu
yaptıktan sonra söz konusu şablonun için VisualStateManager'da
**InValid** statelerini bulabilir ve bu stateler için hazırlanmış
tasarımları değiştirebilirsiniz.

![Blend içerisinde TextBox'a ait ayrı
stateler...](media/Silverlight_3_0_icerisinde_gorsel_veri_validasyonu/03072009_4.png)\
*Blend içerisinde TextBox'a ait ayrı stateler...*

State'ler arası tasarımları değiştirdikten sonra büyük ihtimal ile
InValid durumunde gösterilen Tooltip'in de tasarımını değiştirebilmek
isteyeceksiniz. Blend içerisinden şu an için (Blend 3 MIX Preview
sürümü) bir çözüm bulunmasa da kod tarafından gerekli özelleştirmeleri
yapabiliriz. Textbox'ımızın Template'inden bir kopya alıp editlerken
aslında beraberindeki Tooltip'in tasarımının da bir kopyası
uygulamamızın sayfasında **Resource** olarak saklanıyor.

**[XAML]**

<span style="color: gray;">\<UserControl
xmlns:data="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"</span>

<span style="color: gray">       </span> <span style="color: gray;">
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>

<span style="color: gray">       </span> <span style="color: gray;">
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:vsm="clr-namespace:System.Windows;assembly=System.Windows"
xmlns:System="clr-namespace:System;assembly=mscorlib"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"</span>

<span style="color: gray">       </span> <span style="color: gray;">
x:Class="SilverlightApplication81.MainPage" Width="400" Height="300"
mc:Ignorable="d"\></span>

<span style="color: #a31515;">    </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">UserControl.Resources</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">        </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">ControlTemplate</span><span style="color: red;">
x</span><span style="color: blue;">:</span><span
style="color: red;">Key</span><span
style="color: blue;">="ValidationToolTipTemplate"\></span>

<span style="color: #a31515;">            </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Grid</span><span style="color: red;">
x</span><span style="color: blue;">:</span><span
style="color: red;">Name</span><span
style="color: blue;">="Root"</span><span style="color: red;">
Margin</span><span style="color: blue;">="5,0"</span><span
style="color: red;"> Opacity</span><span
style="color: blue;">="0"</span><span style="color: red;">
RenderTransformOrigin</span><span style="color: blue;">="0,0"\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualStateManager.VisualStateGroups</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                    </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualStateGroup</span><span
style="color: red;"> x</span><span style="color: blue;">:</span><span
style="color: red;">Name</span><span
style="color: blue;">="OpenStates"\></span>

<span style="color: #a31515;">                        </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualStateGroup.Transitions</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                            </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualTransition</span><span
style="color: red;"> GeneratedDuration</span><span
style="color: blue;">="0"/\></span>

<span style="color: #a31515;">                            </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualTransition</span><span
style="color: red;"> GeneratedDuration</span><span
style="color: blue;">="0:0:0.2"</span><span style="color: red;">
To</span><span style="color: blue;">="Open"\></span>

<span style="color: #a31515;">                               
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">Storyboard</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                                   
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">DoubleAnimationUsingKeyFrames</span><span
style="color: red;"> Storyboard.TargetName</span><span
style="color: blue;">="xform"</span><span style="color: red;">
Storyboard.TargetProperty</span><span style="color: blue;">="X"\></span>

<span style="color: #a31515;">                                       
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">SplineDoubleKeyFrame</span><span
style="color: red;"> KeyTime</span><span
style="color: blue;">="0:0:0.2"</span><span style="color: red;">
Value</span><span style="color: blue;">="0"/\></span>

<span style="color: #a31515;">                                   
</span><span style="color: blue;">\</</span><span
style="color: #a31515;">DoubleAnimationUsingKeyFrames</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                                   
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">DoubleAnimationUsingKeyFrames</span><span
style="color: red;"> Storyboard.TargetName</span><span
style="color: blue;">="Root"</span><span style="color: red;">
Storyboard.TargetProperty</span><span
style="color: blue;">="Opacity"\></span>

<span style="color: #a31515;">                                       
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">SplineDoubleKeyFrame</span><span
style="color: red;"> KeyTime</span><span
style="color: blue;">="0:0:0.2"</span><span style="color: red;">
Value</span><span style="color: blue;">="1"/\></span>

<span style="color: #a31515;">                                   
</span><span style="color: blue;">\</</span><span
style="color: #a31515;">DoubleAnimationUsingKeyFrames</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                               
</span><span style="color: blue;">\</</span><span
style="color: #a31515;">Storyboard</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                            </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualTransition</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                        </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualStateGroup.Transitions</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                        </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualState</span><span style="color: red;">
x</span><span style="color: blue;">:</span><span
style="color: red;">Name</span><span
style="color: blue;">="Closed"\></span>

<span style="color: #a31515;">                            </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Storyboard</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                               
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">DoubleAnimationUsingKeyFrames</span><span
style="color: red;"> Storyboard.TargetName</span><span
style="color: blue;">="Root"</span><span style="color: red;">
Storyboard.TargetProperty</span><span
style="color: blue;">="Opacity"\></span>

<span style="color: #a31515;">                                   
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">SplineDoubleKeyFrame</span><span
style="color: red;"> KeyTime</span><span
style="color: blue;">="0"</span><span style="color: red;">
Value</span><span style="color: blue;">="0"/\></span>

<span style="color: #a31515;">                               
</span><span style="color: blue;">\</</span><span
style="color: #a31515;">DoubleAnimationUsingKeyFrames</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                            </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">Storyboard</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                        </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualState</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                        </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualState</span><span style="color: red;">
x</span><span style="color: blue;">:</span><span
style="color: red;">Name</span><span
style="color: blue;">="Open"\></span>

<span style="color: #a31515;">                            </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Storyboard</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                               
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">DoubleAnimationUsingKeyFrames</span><span
style="color: red;"> Storyboard.TargetName</span><span
style="color: blue;">="xform"</span><span style="color: red;">
Storyboard.TargetProperty</span><span style="color: blue;">="X"\></span>

<span style="color: #a31515;">                                   
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">SplineDoubleKeyFrame</span><span
style="color: red;"> KeyTime</span><span
style="color: blue;">="0"</span><span style="color: red;">
Value</span><span style="color: blue;">="0"/\></span>

<span style="color: #a31515;">                               
</span><span style="color: blue;">\</</span><span
style="color: #a31515;">DoubleAnimationUsingKeyFrames</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                               
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">DoubleAnimationUsingKeyFrames</span><span
style="color: red;"> Storyboard.TargetName</span><span
style="color: blue;">="Root"</span><span style="color: red;">
Storyboard.TargetProperty</span><span
style="color: blue;">="Opacity"\></span>

<span style="color: #a31515;">                                   
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">SplineDoubleKeyFrame</span><span
style="color: red;"> KeyTime</span><span
style="color: blue;">="0"</span><span style="color: red;">
Value</span><span style="color: blue;">="1"/\></span>

<span style="color: #a31515;">                               
</span><span style="color: blue;">\</</span><span
style="color: #a31515;">DoubleAnimationUsingKeyFrames</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                            </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">Storyboard</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                        </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualState</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                    </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualStateGroup</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">vsm</span><span
style="color: blue;">:</span><span
style="color: #a31515;">VisualStateManager.VisualStateGroups</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Grid.RenderTransform</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                    </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">TranslateTransform</span><span
style="color: red;"> x</span><span style="color: blue;">:</span><span
style="color: red;">Name</span><span
style="color: blue;">="xform"</span><span style="color: red;">
X</span><span style="color: blue;">="-25"/\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">Grid.RenderTransform</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Border</span><span style="color: red;">
Margin</span><span style="color: blue;">="4,4,-4,-4"</span><span
style="color: red;"> Background</span><span
style="color: blue;">="\#152A2E31"</span><span style="color: red;">
CornerRadius</span><span style="color: blue;">="4"/\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Border</span><span style="color: red;">
Margin</span><span style="color: blue;">="3,3,-3,-3"</span><span
style="color: red;"> Background</span><span
style="color: blue;">="\#252A2E31"</span><span style="color: red;">
CornerRadius</span><span style="color: blue;">="4"/\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Border</span><span style="color: red;">
Margin</span><span style="color: blue;">="2,2,-2,-2"</span><span
style="color: red;"> Background</span><span
style="color: blue;">="\#352A2E31"</span><span style="color: red;">
CornerRadius</span><span style="color: blue;">="4"/\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Border</span><span style="color: red;">
Margin</span><span style="color: blue;">="1,1,-1,-1"</span><span
style="color: red;"> Background</span><span
style="color: blue;">="\#452A2E31"</span><span style="color: red;">
CornerRadius</span><span style="color: blue;">="4"/\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Border</span><span style="color: red;">
Background</span><span style="color: blue;">="\#FFDC000C"</span><span
style="color: red;"> CornerRadius</span><span
style="color: blue;">="4"/\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Border</span><span style="color: red;">
CornerRadius</span><span style="color: blue;">="4"</span><span
style="color: red;"> Background</span><span
style="color: blue;">="Green"\></span>

<span style="color: #a31515;">                    </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">TextBlock</span><span style="color: red;">
Margin</span><span style="color: blue;">="8,3,8,4"</span><span
style="color: red;"> MaxWidth</span><span
style="color: blue;">="250"</span><span style="color: red;">
UseLayoutRounding</span><span style="color: blue;">="false"</span><span
style="color: red;"> Foreground</span><span
style="color: blue;">="White"</span><span style="color: red;">
Text</span><span style="color: blue;">="{</span><span
style="color: #a31515;">Binding</span><span style="color: red;">
Path</span><span style="color: blue;">=(Validation.Errors)[</span>0<span
style="color: blue;">].Exception.Message}"</span><span
style="color: red;"> TextWrapping</span><span
style="color: blue;">="Wrap"/\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">Border</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">            </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">Grid</span><span style="color: blue;">\></span>

<span style="color: #a31515;">        </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">ControlTemplate</span><span
style="color: blue;">\></span>

<span style="color: #808080;">        \<Style x:Key="TextBoxStyle1"
TargetType="TextBox"\></span>

<span style="color: #808080;">            \<Setter
Property="BorderThickness" Value="1"/\></span>

<span style="color: #808080;">            \<Setter Property="Background"
Value="\#FFFFFFFF"/\></span>

<span style="color: #808080;">            \<Setter Property="Foreground"
Value="\#FF000000"/\></span>

<span style="color: #808080;">            \<Setter Property="Padding"
Value="2"/\></span>

Yukarıdaki örnek uygulamaızın XAML kodunun ilk altmış satırını
görebilirsiniz. Bu altmış satır içerisinde önemli olan şey
**ValidationToolTipTemplate** adındaki ControlTemplate nesnesi. Söz
konusu nesne TextBox'ın Template'i içerisinde de kullanılıyor. Aşağıdaki
TextBox'ımızın Template'ine ait XAML kodu içerisinde yukarıdaki
ControlTemplate'in nasıl kullanıldığını görebilirsiniz.

**[XAML]**

<span style="color: gray;">\<Border x:Name="ValidationErrorElement"
Visibility="Collapsed" BorderBrush="\#FFDB000C" BorderThickness="1"
CornerRadius="1"\></span>

<span style="color: #a31515;">                               
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">ToolTipService.ToolTip</span><span
style="color: blue;">\></span>

<span style="color: #a31515;">                                   
</span><span style="color: blue;">\<</span><span
style="color: #a31515;">ToolTip</span><span style="color: red;">
x</span><span style="color: blue;">:</span><span
style="color: red;">Name</span><span
style="color: blue;">="validationTooltip"</span><span
style="color: red;"> DataContext</span><span
style="color: blue;">="{</span><span
style="color: #a31515;">Binding</span><span style="color: red;">
RelativeSource</span><span style="color: blue;">={</span><span
style="color: #a31515;">RelativeSource</span><span style="color: red;">
TemplatedParent</span><span style="color: blue;">}}"</span><span
style="color: red;"> **Template**</span><span
style="color: blue;">**="{**</span><span
style="color: #a31515;">**StaticResource**</span><span
style="color: red;"> **ValidationToolTipTemplate**</span><span
style="color: blue;">**}"**</span><span style="color: red;">
Placement</span><span style="color: blue;">="Right"</span><span
style="color: red;"> PlacementTarget</span><span
style="color: blue;">="{</span><span
style="color: #a31515;">Binding</span><span style="color: red;">
RelativeSource</span><span style="color: blue;">={</span><span
style="color: #a31515;">RelativeSource</span><span style="color: red;">
TemplatedParent</span><span style="color: blue;">}}"\></span>

<span style="color: #a31515;">                                   
</span> <span style="color: #808080;">    </span> <span
style="color: #808080;">\<ToolTip.Triggers\></span>

<span style="color: #808080;">                                       
    \<EventTrigger RoutedEvent="Canvas.Loaded"\></span>

<span style="color: #808080;">                                       
        \<BeginStoryboard\></span>

<span style="color: #808080;">                                       
            \<Storyboard\></span>

<span style="color: #808080;">                                       
                \<ObjectAnimationUsingKeyFrames
Storyboard.TargetName="validationTooltip"
Storyboard.TargetProperty="IsHitTestVisible"\></span>

<span style="color: #808080;">                                       
                    \<DiscreteObjectKeyFrame KeyTime="0"\></span>

<span style="color: #808080;">                                       
                        \<DiscreteObjectKeyFrame.Value\></span>

<span style="color: #808080;">                                       
                           
\<System:Boolean\>true\</System:Boolean\></span>

<span style="color: #808080;">                                       
                        \</DiscreteObjectKeyFrame.Value\></span>

<span style="color: #808080;">                                       
                    \</DiscreteObjectKeyFrame\></span>

<span style="color: #808080;">                                       
                \</ObjectAnimationUsingKeyFrames\></span>

<span style="color: #808080;">                                       
            \</Storyboard\></span>

<span style="color: #808080;">                                       
        \</BeginStoryboard\></span>

<span style="color: #808080;">                                       
    \</EventTrigger\></span>

<span style="color: #808080;">                                       
\</ToolTip.Triggers\></span>

<span style="color: #808080;">                                   
\</ToolTip\></span>

<span style="color: #808080;">                               
\</ToolTipService.ToolTip\></span>

<span style="color: #808080;">                                \<Grid
Height="12" HorizontalAlignment="Right" Margin="1,-4,-4,0"
VerticalAlignment="Top" Width="12" Background="Transparent"\></span>

<span style="color: #808080;">                                    \<Path
Fill="\#FFDC000C" Margin="1,3,0,0" Data="M 1,0 L6,0 A 2,2 90 0 1 8,2
L8,7 z"/\></span>

<span style="color: #808080;">                                    \<Path
Fill="\#ffffff" Margin="1,3,0,0" Data="M 0,0 L2,0 L 8,6 L8,8"/\></span>

<span style="color: #808080;">                               
\</Grid\></span>

<span style="color: #808080;">                           
\</Border</span><span style="color: blue;">\></span>

TextBox'ın Template'i içerisinde bulunan bir **Border** nesnesine
**Tooltip** kontrolü atanmış. Söz konusu **Tooltip** kontrolünün şablonu
ise doğrudan **ValidationToolTipTemplate** adındaki şablonla
eşleştirilmiş durumda. Böylece biz doğrudan ValidationToolTipTemplate
nesnesini değiştirerek validasyon esnasında görülen Tooltip'i
değiştirebiliriz.

**[XAML]**

<span style="color: #a31515;">                </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">Border</span><span style="color: red;">
CornerRadius</span><span style="color: blue;">="4"</span><span
style="color: red;"> Background</span><span
style="color: blue;">="Green"\></span>

<span style="color: #a31515;">                    </span><span
style="color: blue;">\<</span><span
style="color: #a31515;">TextBlock</span><span style="color: red;">
Margin</span><span style="color: blue;">="8,3,8,4"</span><span
style="color: red;"> MaxWidth</span><span
style="color: blue;">="250"</span><span style="color: red;">
UseLayoutRounding</span><span style="color: blue;">="false"</span><span
style="color: red;"> Foreground</span><span
style="color: blue;">="White"</span><span style="color: red;">
Text</span><span style="color: blue;">="{</span><span
style="color: #a31515;">Binding</span><span style="color: red;">
Path</span><span style="color: blue;">=(Validation.Errors)[</span>0<span
style="color: blue;">].Exception.Message}"</span><span
style="color: red;"> TextWrapping</span><span
style="color: blue;">="Wrap"/\></span>

<span style="color: #a31515;">                </span><span
style="color: blue;">\</</span><span
style="color: #a31515;">Border</span><span
style="color: blue;">\></span>

Yukarıdaki kesiti **ValidationToolTipTemplate** içerisinden aldım.
Tooltip şablonu içerisinde buradaki Textblock'un Text'i görüldüğü üzere
bir **Binding** ile beraber geliyor. Arkaplanda yolladığımız
**Exception'ların** mesajlarının **Tooltip** içerisinde gözükmesini
sağlayan sistem bu bindingden ibaret. Eğer burayı silersiniz
mesajlarınız gözükmeyecektir o nedenle tasarımınızı değiştirirken bu
noktaya dikkat etmekte fayda var.

Hepinize kolay gelsin.


*Bu yazi http://daron.yondem.com adresinde, 2009-7-4 tarihinde yayinlanmistir.*